#!/usr/bin/env python
# Orriginal script has been taken from:
#   https://unix.stackexchange.com/questions/164602/how-to-output-the-directory-structure-to-json-format
# With some modifications.

import os


def path_hierarchy(path):
    if os.path.isfile(path):
        return os.path.getsize(path)

    return {contents: path_hierarchy(os.path.join(path, contents)) for contents in os.listdir(path)}


if __name__ == '__main__':
    import json
    import sys

    if len(sys.argv) == 1:
        sys.argv.append(".")

    for i in sys.argv[1:]:
        print(json.dumps(path_hierarchy(i), sort_keys=True))
